----------邏輯說明與備註----------

PoE_AffixReader的運作邏輯：操作前與操作後都執行ctrl+c的複製動作，針對複製出來的物品資訊，進行辨識與操作。若物品資訊符合affix中的設置條件，就完成洗詞綴的操作需求。

操作紀錄：AffixReader在判斷詞綴是否達標後，會在當前資料夾生成一個log_affix.txt檔案，檔案中紀錄了當前的物品資訊與AffixReader的判斷結果。在不熟悉使用或不熟悉詞綴的設定時請頻繁檢查操作紀錄，以免錯誤。

----------使用教學----------

行前安裝：
1. 下載並安裝[AutoHotKey](https://www.autohotkey.com/)。 如果會閃退或沒反應，試試看改用我編寫時的版本號 `AutoHotkey_1.1.34.02`。

下載檔案後：
1.使用前請關閉會互相干擾的程式或按鍵設定，例如POE_UtilityBundles或其他與此精靈重複的按鍵設置。
2.右鍵以記事本或其他開發工具點開想要使用的程式，依照設定教學設定好所需詞綴及參數之後，左鍵雙擊即可開始使用。
3.只能同時使用一種洗詞綴檔案，長按F12為停止鍵。
4.F7按鍵可依照滑鼠游標位置設置各通貨的座標位置，預設座標的螢幕尺寸為2560x1440。
5.F4按鍵則開始洗詞綴。

----------設定教學----------

[通貨座標]
	遊戲視窗大小設置：解析度2560x1440且無邊框模式時不用改動，維持預設。
	其他視窗大小皆需使用F7按鍵工具設定通貨石座標，或開啟setting.ini手動修改。

[targetAffixNum]
	想要的目標詞墜數量。
	檔案名稱有註明該方案可支援的詞綴數量。
		例如「洗金_重鑄點金循環_目標一或二或三詞」代表此處可設置1或2或3，請依照當下需求進行設置。
	向上相容，例如targetAffixNum = 1 時，物品洗出兩項符合affix中設置的項目，此時會停止操作。並且在log_affix中顯示該次操作紀錄為conformNum = 2。

[affix]

	在此處設定你想保留的詞綴文字，可指定數字，例如: "7% 最大生命"
	若想指定範圍詞墜可用以下範例自行修改，請先查清楚你的裝備種類與物等，以免永遠也洗不出來，並且注意空格一個都不能少。
	
	詞墜全文，詳細請參考編年史：
	https://poedb.tw/tw/Modifiers

	基礎範例：

		[0-9]*的意思就是任意整數數字，包括0-99999，詳細使用方法可以查詢正規表達式 
		(46|47|48)%是指46%或47%或48%

		範例：
			"(46|47|48)% 閃電抗性"
			"(110|111|112|113|114|115|116|117|118|119) 最大生命"
			"攻擊技能增加 (37|38|39|40|41|42)% 元素傷害"
			"附加 [0-9]*% 至 [0-9]*% 火焰傷害"
	
	註解方式：
	
		平時沒使用的條件可以留在檔案中，但請以冒號註解起來，節省運作資源、加快運作速度，也方便日後使用。
		但記得使用前請對照編年史，確定詞綴內容是否有異動。
		
		該條件已有冒號，在PoE_AffixReader中是註解不會運行：
		;affix.Push(["Grim Oath","Overwhelming Malice","Touch of Cruelty","Unwaveringly Evil","Unspeakable Gifts","Dark Ideation","Unholy Grace","Wicked Pall"])
		
		該條件沒有冒號，在PoE_AffixReader中會運行：
		affix.Push(["Sadist","Corrosive Elements","Doryani's Lesson","Disorienting Display","Prismatic Heart","Widespread Destruction","Master of Fire","Smoking Remains","Cremator","Burning Bright"])

	
	注意事項：
		1.確定詞綴的字串足夠獨特，否則將在使用預期外結束動作。只要足夠獨特，可接受模糊查詢，也就是前後可少字的詞綴敘述。

		不夠獨特範例：
			(1)同時符合多種抗性的相關描述。
				"抗性"
			(2)在特殊基底上重複。若在The Crusader的武器上會同時符合穿透閃電抗性和閃電抗性。
				"閃電抗性"
			(3)除了詞綴內容，同時可能出現在裝備名稱、裝備需求中。
				"敏捷"
			
		足夠獨特：
			(1)在一般裝備上已限定詞綴。
				"混沌抗性"。
			(2)在The Crusader的武器上限定了該詞綴。
				"穿透 (13|14|15)% 閃電抗性"。
			(3)標註明確數字，避開裝備名稱與裝備需求。
				"(51|52|53|54|55) 敏捷"
			

		2.若需要出現\.*?+[{|()^$這些字符，字符前須要加上一個反斜線，例如+必須要改為\+，否則該條件完全失效。

		錯誤範例：
			affix.Push(["+(36|37|38|39|40|41)% to Cold Resistance"])
		正確範例：
			affix.Push(["\+(3[6789]|4[01])% to Cold Resistance"])


		3.字串部分可使用正規表達式。若數字字串較長，請善用chatgpt等工具，或自行寫python來產生字串。

		範例，下列3行表示相同意思：
			affix.Push(["(36|37|38|39|40|41)% to Cold Resistance"])
			affix.Push(["(3[6789]|4[01])% to Cold Resistance"])
			affix.Push(["(3[6-9]|4[0-1])% to Cold Resistance"])

		4.可接受多種的目標數組(此功能可能有點小狀況，請盡量減少使用。或請提供狀況說明，我再繼續開發維護)：

		範例：
			在targetAffixNum = 2 的使用情境，設置如下，表示同時尋找物品資訊出現組合"尖刺混物"、"釀造之力"與組合"尖刺混物"、"釀造之力"的物品。

			global affix := Array()
			affix.Push(["尖刺混物", "釀造之力"])
			affix.Push(["完美淬鍊", "釀造之力"])

		5.前後綴都有相同詞綴敘述的情況：
			以珠寶為例，若設置如下：
				affix.Push(["增加 [0-9]*% 攻擊速度"])
			會同時符合前綴的"持盾時增加 [0-9]*% 攻擊速度"與後綴的"增加 [0-9]*% 攻擊速度"。
			此時需要增加辨識度。
				1.修改遊戲中詞綴顯示的文本：
					例如若你有修改遊戲文本，遊戲內已顯示該物品為"[後] 增加 3% 攻擊速度(珠3%-5%)"
					此時在詞綴前加一個空格，就可成功分開辨識。
						affix.Push([" 增加 [0-9]*% 攻擊速度"])
								
				2.檢查其他可供檢查的文本內容，例如換行符號或前依據的內容：
					(1)換行符號：
						affix.Push(["\n增加 [0-9]*% 攻擊速度"])

					(2)加上前一句內容，以弓為例，前後綴同時有+命中值，但前綴必定為複合物理%的附屬命中值：
						affix.Push(["增加 [0-9]*% 物理傷害\n\+[0-9]* 命中值"])

	提供數字產生方法：
		1.請chtgpt產生範圍內所有數字並記得以|間格。

		2.開python下指令，產生範圍內所有數字並以|間格。
			指令範例：
			numbers = '|'.join(map(str, range(36, 42)))
			numbers

		3.自行GOOGLE並學習正規表達式。
		
	ahk語法的註解方法：
		
		/*
		中間可註解多行文字。
		*/

		; 半形冒號後是註解文字。並注意若同一行同時存在程式碼與註解，冒號後需要空格，否則視為文法錯誤。

[delay]
	滑鼠的移動速度。要是發現你電腦有疑似滑鼠動太快，而電腦跟不上的問題(可能性不高)，調整此參數0~50來讓滑鼠平滑移動(預設2已是穩定數值，0是順移。)

[clipboardDelay]
	對物品操作後，複製物品資訊前的Delay，目的是等待遊戲反應。是最重要的延遲屬性。單位毫秒。

	通常複製動作會檢查 
		1.操作後的物品狀態和操作前不同
		2.不是稀有度普通的物品，才進行後續的判斷動作。
	所以若數字設定很低，程式其實也會重複複製動作，直到伺服器正確回應為止。只是動作會比較傻屌。
	但因為改造石類型的操作動作很有可能操作前後完全一樣，所以略過此檢查。也就不可設置太低。

	設定此處資料時可檢查log紀錄是否有錯誤資料。
	如在執行重鑄點金類型的精靈時出現itemRarity = 0的資料，代表操作完的複製動作完成後，遊戲卻還沒給出點金石的回應，所以複製到了錯誤的物品狀態。也就是稀有度為普通的物品。
	若排除程式卡控的功能，測試實際伺服器回應速度。我在國際服的clipboardDelay是在150~180之間。請再依照實際的網路及電腦狀況進行調整。

	garena時代的台服設定50很穩偏慢。可惜已是過往。

[pingDelay]
	沒啥屁用，一個設心安用的小Delay。單位為毫秒。
	
[conformDelay]	
	同上意思，只是作用在實際判定詞墜的操作之前，在較為複雜的多重判定時有點用。


[debugModeDelay]
	與程式運作無關，單純用來進行肉眼確認的額外延遲時間，預設0是已合理的最高速運行，要是想讓它跑慢點測試，可以設為1000(就是1秒)

其餘設定不太重要，若有好奇請詳閱程式碼。

另外，若你有手動修改這些ahk檔案，請記得檢查檔案編碼：	
	PoE_AffixReader.ahk的編碼必須是UTF-8 BOM
	setting.ini的編碼必須是UTF-16 LE BOM 或 UCS LE